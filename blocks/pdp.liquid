{% assign featuredReviews = product.metafields.custom.featured_reviews.value %}

<div class="product">
    <div class="flex gap-4 md:gap-[3rem] flex-col md:flex-row">
        <div class="product__gallery flex-shrink-0 md:w-[50%] lg:w-[54rem]">
            {% render 'product-gallery' %}

            {% if featuredReviews != blank %}
                <div class="hidden md:block">
                    {% if featuredReviews != blank %}
                        <div class="carousel overflow-hidden w-full mt-[1.6rem]" id="featured-reviews-desktop">
                            <div class="carousel__content swiper">
                                <div class="swiper-wrapper">
                                    {% for review in featuredReviews %}
                                        <div class="swiper-slide">
                                            {% render 'featured-review', name: review.name, image: review.author_image, text: review.text %}
                                        </div>
                                    {% endfor %}
                                </div>
                                <div class="swiper-pagination"></div>
                            </div>
                        </div>
                    
                        <script>
                            document.addEventListener('DOMContentLoaded', () => {
                                const swiper = new Swiper('#featured-reviews-desktop .swiper', {
                                    slidesPerView: 1,
                                    spaceBetween: 12,
                                    autoHeight: true,
                                    pagination: {
                                        el: '.swiper-pagination',
                                        clickable: true,
                                    }
                                });
                            });
                        </script>
                    {% endif %}
                </div>
            {% endif %}
        </div>
        <div class="product__info">
            {% content_for 'blocks' %}

            {% if featuredReviews != blank %}
                <div class="block md:hidden">
                    {% if featuredReviews != blank %}
                        <div class="carousel overflow-hidden w-full mt-[1.6rem]" id="featured-reviews-mobile">
                            <div class="carousel__content swiper">
                                <div class="swiper-wrapper">
                                    {% for review in featuredReviews %}
                                        <div class="swiper-slide">
                                            {% render 'featured-review', name: review.name, image: review.author_image, text: review.text %}
                                        </div>
                                    {% endfor %}
                                </div>
                                <div class="swiper-pagination"></div>
                            </div>
                        </div>
                    
                        <script>
                            document.addEventListener('DOMContentLoaded', () => {
                                const swiper = new Swiper('#featured-reviews-mobile .swiper', {
                                    slidesPerView: 1,
                                    spaceBetween: 12,
                                    autoHeight: true,
                                    pagination: {
                                        el: '.swiper-pagination',
                                        clickable: true,
                                    }
                                });
                            });
                        </script>
                    {% endif %}
                </div>
            {% endif %}
        </div>
    </div>
</div>



{% stylesheet %}
.swiper-pagination  {
    padding-top: 1.6rem !important;
}

.product__feature-review-image img {
    object-fit: cover;
    width: 100%;
    height: 100%;
}
{% endstylesheet %}

{% schema %}
{
  "name": "Product",
  "blocks": [
    {
        "type": "heading",
    },
    {
        "type": "inline-review",
    },
    {
        "type": "text",
    },
    {
        "type": "features-list",
    },
    {
        "type": "_pdp-cta",
    },
    {
        "type": "_pdp-faq",
    }
    
  ],
  "presets": [
    {
      "name": "Product"
    }
  ]
}
{% endschema %}

